Version 4
SHEET 1 1572 776
WIRE 0 64 -112 64
WIRE 112 64 0 64
WIRE 288 64 192 64
WIRE 384 64 288 64
WIRE 560 64 384 64
WIRE 720 64 640 64
WIRE 816 64 720 64
WIRE 1024 64 880 64
WIRE 1072 64 1024 64
WIRE 1120 64 1072 64
WIRE -112 80 -112 64
WIRE 720 112 720 64
WIRE 0 160 0 64
WIRE 384 160 384 64
WIRE 1024 160 1024 64
WIRE 1120 176 1120 64
WIRE 592 192 512 192
WIRE 672 192 592 192
WIRE 512 288 512 272
WIRE -112 320 -112 160
WIRE 0 320 0 224
WIRE 0 320 -112 320
WIRE 384 320 384 224
WIRE 384 320 0 320
WIRE 720 320 720 208
WIRE 720 320 384 320
WIRE 1024 320 1024 224
WIRE 1024 320 720 320
WIRE 1120 320 1120 256
WIRE 1120 320 1024 320
WIRE 0 352 0 320
FLAG 0 352 0
FLAG 288 64 Array_out
FLAG 592 192 PWM_IN
FLAG 1072 64 V_out
FLAG 512 288 0
FLAG 720 64 SW
SYMBOL res 96 80 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R1
SYMATTR Value 0.010
SYMBOL diode -16 160 R0
SYMATTR InstName D1
SYMATTR Value DiodeSolarCell
SYMBOL ind 544 80 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L1
SYMATTR Value 150µH
SYMBOL nmos 672 112 R0
SYMATTR InstName M1
SYMATTR Value BSC060N10NS3
SYMBOL diode 816 80 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D2
SYMBOL voltage 512 176 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value PULSE(0 20 0 0 0 1.1e-5 2e-5 100000)
SYMBOL cap 368 160 R0
SYMATTR InstName C2
SYMATTR Value 330µF
SYMBOL voltage 1120 160 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V2
SYMATTR Value 96
SYMBOL current -112 160 R180
WINDOW 0 24 80 Left 2
WINDOW 3 24 0 Left 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName I1
SYMATTR Value 7A
SYMBOL cap 1008 160 R0
SYMATTR InstName C1
SYMATTR Value 330µF
TEXT -176 328 Left 2 !.tran 0 0.005 0
TEXT -176 424 Left 2 !.model DiodeSolarCell D LEVEL=1 IS=8.0411e-10 N=72.2592 EG=80.2077 XTI=216.7776
TEXT -168 0 Left 2 ;MPP for this solar model is at 37.7V, 6.5A load
TEXT -152 480 Left 2 !.MEAS Pin  RMS V(Array_out)*I(R1)
TEXT 1016 416 Left 2 !.MEAS Iout RMS I(D2)
TEXT 1016 448 Left 2 !.MEAS Pout AVG V(V_out)*Iout
TEXT 1008 680 Left 2 !.MEAS PWR_Eff AVG Pout/Pin
TEXT -152 512 Left 2 !.MEAS Ein INTEG Pin
TEXT 1016 536 Left 2 !.MEAS Eout INTEG Pout
TEXT 1016 568 Left 2 !.MEAS Eout2 INTEG V(V_out)*I(D2)
TEXT 1456 568 Left 2 ;JOULES
TEXT 128 512 Left 2 ;JOULES
TEXT 1376 456 Left 2 ;WATT
TEXT 272 480 Left 2 ;WATT
TEXT 1000 720 Left 2 !.MEAS ENERGY_EFF_RMS  AVG Eout/Ein
TEXT 1336 536 Left 2 ;JOULES
TEXT 1000 760 Left 2 !.MEAS ENERGY_EFF_RAW  AVG Eout2/Ein
